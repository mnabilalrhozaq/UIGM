<!DOCTYPE html>
<html>
<head>
    <title>Panduan Test Sederhana - Perbaikan Save Data</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .step { margin: 15px 0; padding: 15px; background: #f8f9fa; border-left: 4px solid #007bff; }
        .success { background: #d4edda; border-left-color: #28a745; }
        .error { background: #f8d7da; border-left-color: #dc3545; }
        .warning { background: #fff3cd; border-left-color: #ffc107; }
        .code { background: #e9ecef; padding: 2px 6px; border-radius: 3px; font-family: monospace; }
        .highlight { background: yellow; padding: 2px 4px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ”§ Panduan Test Sederhana - Perbaikan Save Data</h1>
    
    <div class="step success">
        <h3>âœ… Perbaikan Terbaru yang Diterapkan</h3>
        <ul>
            <li><strong>Enhanced Logging:</strong> Logging detail di controller untuk tracking</li>
            <li><strong>CSRF Token:</strong> Ditambahkan CSRF token untuk keamanan</li>
            <li><strong>Debug Controller:</strong> Controller khusus untuk testing</li>
            <li><strong>Error Handling:</strong> Penanganan error yang lebih baik</li>
        </ul>
    </div>

    <div class="step">
        <h3>ğŸ§ª Langkah Test (5 Menit)</h3>
        
        <h4>1. Bersihkan Browser (30 detik)</h4>
        <ul>
            <li>Tekan <span class="code">Ctrl+Shift+Delete</span></li>
            <li>Hapus cookies dan cache untuk localhost:8080</li>
            <li>Tutup semua tab browser</li>
        </ul>

        <h4>2. Login Fresh (1 menit)</h4>
        <ul>
            <li>Buka: <a href="http://localhost:8080/auth/login" target="_blank">Login Page</a></li>
            <li>Username: <span class="code">admin_unit</span></li>
            <li>Password: <span class="code">password123</span></li>
        </ul>

        <h4>3. Cek Debug Info (1 menit)</h4>
        <ul>
            <li>Buka: <a href="http://localhost:8080/debug/check-database" target="_blank">Check Database</a></li>
            <li>Pastikan ada data pengiriman dengan status 'draft'</li>
            <li>Buka: <a href="http://localhost:8080/debug/check-session" target="_blank">Check Session</a></li>
            <li>Pastikan user admin_unit terdeteksi</li>
        </ul>

        <h4>4. Test Dashboard (2 menit)</h4>
        <ul>
            <li>Buka: <a href="http://localhost:8080/admin-unit/dashboard" target="_blank">Dashboard</a></li>
            <li><span class="highlight">Buka Developer Tools (F12)</span></li>
            <li>Pergi ke tab <strong>Console</strong></li>
            <li>Cari pesan: <span class="code">DEBUG: CAN_EDIT = true</span></li>
        </ul>

        <h4>5. Test Save dengan Monitoring (1 menit)</h4>
        <ul>
            <li>Buka kategori WS (Waste)</li>
            <li>Isi data minimal:
                <ul>
                    <li><strong>Tanggal:</strong> Hari ini</li>
                    <li><strong>Gedung:</strong> Gedung A</li>
                    <li><strong>Jumlah:</strong> 100</li>
                    <li><strong>Satuan:</strong> kg</li>
                    <li><strong>Deskripsi:</strong> Test data sistem UIGM</li>
                </ul>
            </li>
            <li><span class="highlight">Pergi ke tab Network di Developer Tools</span></li>
            <li>Klik tombol <strong>"Simpan"</strong></li>
            <li>Lihat apakah ada request ke <span class="code">simpan-kategori</span></li>
        </ul>
    </div>

    <div class="step warning">
        <h3>âš ï¸ Yang Harus Diperiksa</h3>
        
        <h4>âœ… Indikator Berhasil:</h4>
        <ul>
            <li>Console menunjukkan: <span class="code">DEBUG: CAN_EDIT = true</span></li>
            <li>Tab Network menunjukkan request POST ke <span class="code">simpan-kategori</span></li>
            <li>Response status: <span class="code">200 OK</span></li>
            <li>Response JSON: <span class="code">{"success": true, "message": "Data berhasil disimpan"}</span></li>
            <li>Toast hijau muncul: "Data berhasil disimpan"</li>
        </ul>

        <h4>âŒ Indikator Masalah:</h4>
        <ul>
            <li>Console menunjukkan: <span class="code">DEBUG: CAN_EDIT = false</span></li>
            <li>Tidak ada request di tab Network</li>
            <li>Response status: <span class="code">500</span> atau <span class="code">404</span></li>
            <li>Toast orange: "Data tidak dapat diedit"</li>
            <li>Error merah di console</li>
        </ul>
    </div>

    <div class="step error">
        <h3>ğŸš¨ Jika Masih Bermasalah</h3>
        
        <h4>Cek Log File:</h4>
        <p>Buka file: <span class="code">writable/logs/log-<?= date('Y-m-d') ?>.log</span></p>
        <p>Cari pesan yang dimulai dengan:</p>
        <ul>
            <li><span class="code">DEBUG - simpanKategori called</span></li>
            <li><span class="code">ERROR - Error in simpanKategori</span></li>
        </ul>

        <h4>Test Manual Save:</h4>
        <p>Buka: <a href="http://localhost:8080/debug/test-save" target="_blank">Test Save</a></p>
        <p>Halaman ini akan test penyimpanan data secara langsung</p>

        <h4>Kemungkinan Penyebab:</h4>
        <ol>
            <li><strong>Database Error:</strong> Tabel atau kolom tidak ada</li>
            <li><strong>Permission Error:</strong> User tidak punya akses write</li>
            <li><strong>JavaScript Error:</strong> Function tidak terpanggil</li>
            <li><strong>CSRF Error:</strong> Token tidak valid</li>
            <li><strong>Session Error:</strong> User tidak terautentikasi</li>
        </ol>
    </div>

    <div class="step">
        <h3>ğŸ“‹ Data Test yang Bisa Digunakan</h3>
        <pre>
Tanggal Input: <?= date('Y-m-d') ?>

Gedung: Gedung A
Jumlah: 100
Satuan: kg
Deskripsi: Test data untuk sistem UIGM - deskripsi minimal 10 karakter
        </pre>
    </div>

    <script>
        console.log('ğŸ”§ Test Guide loaded');
        console.log('ğŸ“… Current time:', new Date().toLocaleString());
        
        // Test jQuery availability
        if (typeof $ !== 'undefined') {
            console.log('âœ… jQuery available');
        } else {
            console.log('âŒ jQuery not available');
        }
    </script>
</body>
</html>